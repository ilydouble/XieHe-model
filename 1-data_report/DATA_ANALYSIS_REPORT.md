# 脊柱 X 光片数据集分析报告

> 分析时间: 2025-12-03  
> 项目: 基于 YOLO 的脊柱 X 光片分析

---

## 1. 数据集概览

本项目包含三个核心数据集，用于不同的脊柱分析任务：

| 数据集 | 任务类型 | 图像数量 | 目标数量 | 类别数 |
|--------|----------|----------|----------|--------|
| `pose_data` | 关键点检测 | 1,565 | 1,565 | 1 |
| `seg_data` | 实例分割 | 1,387 | 25,021 | 20 |
| `pose_corner_data` | 角点检测 | 1,386 | ~24,948 | 18 |

---

## 2. Pose 数据集 (躯干标志点)

### 2.1 基本信息

| 指标 | 值 |
|------|-----|
| 总图像数量 | 1,565 |
| 总标签数量 | 1,565 |
| 标签完整性 | 100% |
| 平均目标/图像 | 1.0 |
| 类别数量 | 1 (person) |

### 2.2 数据集划分

| 划分 | 数量 | 比例 |
|------|------|------|
| Train | 1,252 | 80% |
| Val | 157 | 10% |
| Test | 156 | 10% |

### 2.3 图像尺寸统计

| 指标 | 宽度 | 高度 |
|------|------|------|
| 最小值 | 1,228 px | 2,180 px |
| 最大值 | 3,208 px | 7,338 px |
| 平均值 | 2,358 px | 4,486 px |

### 2.4 关键点定义 (6个)

| 索引 | 名称 | 说明 |
|------|------|------|
| 0 | CR | 右侧锁骨最高点 |
| 1 | CL | 左侧锁骨最高点 |
| 2 | IR | 右侧髂骨最高点 |
| 3 | IL | 左侧髂骨最高点 |
| 4 | SR | 骶一上终板右缘点 |
| 5 | SL | 骶一上终板左缘点 |

### 2.5 关键点可见性

| 指标 | 值 |
|------|-----|
| 总关键点数 | 9,390 |
| 可见率 | 56.17% |
| 不可见率 | 43.83% |
| 缺失率 | 0.00% |

---

## 3. Segmentation 数据集 (椎骨分割)

### 3.1 基本信息

| 指标 | 值 |
|------|-----|
| 总图像数量 | 1,387 |
| 总标签数量 | 1,387 |
| 总目标数量 | 25,021 |
| 标签完整性 | 100% |
| 平均目标/图像 | 18.04 |
| 类别数量 | 20 |

### 3.2 数据集划分

| 划分 | 数量 | 比例 |
|------|------|------|
| Train | 1,109 | 80% |
| Val | 139 | 10% |
| Test | 139 | 10% |

### 3.3 类别分布

| 类别ID | 名称 | 数量 | 说明 |
|--------|------|------|------|
| 0 | C7 | 1,387 | 颈椎 7 |
| 1 | T1 | 1,387 | 胸椎 1 |
| 2 | T2 | 1,387 | 胸椎 2 |
| 3 | T3 | 1,387 | 胸椎 3 |
| 4 | T4 | 1,387 | 胸椎 4 |
| 5 | T5 | 1,387 | 胸椎 5 |
| 6 | T6 | 1,387 | 胸椎 6 |
| 7 | T7 | 1,387 | 胸椎 7 |
| 8 | T8 | 1,387 | 胸椎 8 |
| 9 | T9 | 1,387 | 胸椎 9 |
| 10 | T10 | 1,387 | 胸椎 10 |
| 11 | T11 | 1,387 | 胸椎 11 |
| 12 | T12 | 1,387 | 胸椎 12 |
| 13 | L1 | 1,387 | 腰椎 1 |
| 14 | L2 | 1,387 | 腰椎 2 |
| 15 | L3 | 1,387 | 腰椎 3 |
| 16 | L4 | 1,387 | 腰椎 4 |
| 17 | L5 | 1,387 | 腰椎 5 |
| 18 | L6 | 44 | 腰椎 6 (少见变异) |
| 19 | T13 | 11 | 胸椎 13 (少见变异) |

### 3.4 分割掩码统计

| 指标 | 值 |
|------|-----|
| 平均点数/掩码 | 74.1 |
| 最少点数 | 4 |
| 最多点数 | 246 |

### 3.5 数据问题

- **缺失标签**: 1 张图片
  - `test/1.2.156.147522.44.410947.1583.1.1.20250612153329.png`

---

## 4. Pose Corner 数据集 (椎骨角点)

### 4.1 基本信息

| 指标 | 值 |
|------|-----|
| 总图像数量 | 1,386 |
| 类别数量 | 18 (V0-V17) |
| 关键点数量 | 4 (四角) |
| 数据来源 | 从 seg_data 自动提取 |

### 4.2 关键点定义 (4个)

| 索引 | 名称 | 说明 |
|------|------|------|
| 0 | Top-Left | 左上角 |
| 1 | Top-Right | 右上角 |
| 2 | Bottom-Right | 右下角 |
| 3 | Bottom-Left | 左下角 |

### 4.3 类别映射

| 类别ID | 名称 | 对应椎骨 |
|--------|------|----------|
| V0 | C7 | 颈椎 7 |
| V1-V12 | T1-T12 | 胸椎 1-12 |
| V13-V17 | L1-L5 | 腰椎 1-5 |

---

## 5. 模型训练结果

### 5.1 Pose Corner 模型性能

训练配置:
- 模型: YOLO11n-pose
- Epochs: 300
- Image Size: 640
- Batch Size: 16

#### 最终指标 (Epoch 300)

| 指标 | 值 | 说明 |
|------|-----|------|
| **mAP50(B)** | 98.78% | Bbox 检测精度 @IoU=0.5 |
| **mAP50-95(B)** | 74.69% | Bbox 检测精度 @IoU=0.5:0.95 |
| **mAP50(P)** | 98.84% | 关键点精度 @OKS=0.5 |
| **mAP50-95(P)** | 97.02% | 关键点精度 @OKS=0.5:0.95 ⭐ |
| **Precision** | 97.70% | 检测准确率 |
| **Recall** | 97.03% | 检测召回率 |

#### Loss 收敛情况

| Loss 类型 | 初始值 | 最终值 | 下降幅度 |
|-----------|--------|--------|----------|
| box_loss | 4.64 | 0.83 | ↓ 82% |
| pose_loss | 7.44 | 0.17 | ↓ 98% |
| cls_loss | 5.78 | 0.38 | ↓ 93% |

#### 结论

✅ **模型效果优秀**
- 关键点定位 mAP50-95 达到 **97%**，4个角点定位精准
- 检测和分类稳定，Precision/Recall 均在 97% 以上
- Loss 持续收敛，无过拟合迹象

---

## 6. 数据质量总结

### 6.1 优势

| 方面 | 评估 |
|------|------|
| 标注完整性 | ✅ 99.9% (仅1张缺失) |
| 数据量 | ✅ 充足 (1300+ 张) |
| 类别平衡 | ✅ 主要18类均衡分布 |
| 图像质量 | ✅ 高分辨率 (平均 2358×4486) |

### 6.2 注意事项

| 问题 | 说明 |
|------|------|
| 变异椎骨 | L6 仅 44 例，T13 仅 11 例，样本较少 |
| 关键点遮挡 | Pose 数据集中 43.83% 关键点不可见 |
| 缺失标签 | 1 张测试图片无标注 |

### 6.3 建议

1. **变异椎骨处理**: 可考虑数据增强或将 L6/T13 合并到邻近类别
2. **遮挡关键点**: 模型训练时需要处理不可见关键点
3. **数据清洗**: 已排除缺失标签的图片

---

## 7. 附录

### 7.1 目录结构

```
Model/
├── pose_data/              # Pose 数据集
│   ├── images/{train,val,test}/
│   ├── labels/{train,val,test}/
│   └── dataset.yaml
├── seg_data/               # Segmentation 数据集
│   ├── images/{train,val,test}/
│   ├── labels/{train,val,test}/
│   └── dataset.yaml
├── pose_corner_data/       # Pose Corner 数据集
│   ├── images/{train,val,test}/
│   ├── labels/{train,val,test}/
│   └── dataset.yaml
└── runs/                   # 训练结果
    ├── pose/
    └── pose_corner/
```

### 7.2 标注格式

**Pose 标签格式:**
```
class x_c y_c w h kp1_x kp1_y kp1_v kp2_x kp2_y kp2_v ...
```

**Segmentation 标签格式:**
```
class x1 y1 x2 y2 x3 y3 ...
```

**Pose Corner 标签格式:**
```
class x_c y_c w h corner1_x corner1_y corner1_v corner2_x corner2_y corner2_v ...
```

---

*报告生成工具: `1-data_report/analyze_dataset.py`*

